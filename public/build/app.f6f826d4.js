"use strict";(self.webpackChunkcompanyos_backend=self.webpackChunkcompanyos_backend||[]).push([[524],{7205:(e,n,t)=>{var r={};t.r(r),t.d(r,{AppBreadcrumb:()=>we,AppFooter:()=>Ee,AppHeader:()=>Le,AppHeaderDropdownAccnt:()=>xe,AppSidebar:()=>Ae,AppSidebarNav:()=>_e});var o=t(2284),a=t(467),i=t(296),c=t(4756),s=t.n(c),u=(t(2675),t(9463),t(2259),t(6280),t(6918),t(8706),t(2008),t(1629),t(3792),t(3418),t(4346),t(2062),t(4114),t(4782),t(3288),t(2010),t(5506),t(9432),t(6099),t(3362),t(7495),t(906),t(8781),t(7764),t(5440),t(1392),t(8992),t(4520),t(3949),t(1454),t(3500),t(2953),t(1425)),l=t(5220),d=t(1774),p=t(3985),f=t(1083),m=t(4918),v=((0,d.nY)("theme",function(){var e=(0,u.KR)("light");return{theme:e,toggleTheme:function(n){e.value=n}}}),t(7383)),h=t(291),b=t(9731),g=t(5938),k=t(5517),C=t(4815),_=t(3182),y=t(6404),A=t(5032),w=t(5673),F=t(7904),x=t(8580),L=t(9714),R=t(9677),S=t(4010),E=t(7917),I=t(4328),T=t(5920),D=t(3390),P=t(5833),W=t(9742),O=t(4744),N=t(9342),X=t(1240),B=t(3330),q=t(3867),j=t(4769),M=t(2120),z=t(2513),H=t(3769),U=t(2338),V=t(2843),K=t(9489),Q=t(3905),G=t(9262),$=t(3384),Y=t(3634),Z=t(9550),J=t(2286),ee=t(9165),ne=t(6487),te=t(5721),re=t(2860),oe=t(8012),ae=t(3400),ie=t(1785),ce=t(6005),se=t(1793),ue=t(5196),le=t(6738),de={cilHome:h.K,cilUser:b.o,cilLockLocked:g.q,cilSettings:k.e,cilMenu:C.o,cilX:_.X,cilList:y.R,cilPlus:A.x,cilPencil:w.K,cilTrash:F.Z,cilSearch:x.B,cilFilter:L.R,cilSave:R.M,cilCheck:S.B,cilWarning:E.p,cilInfo:I.v,cilStar:T.p,cilPhone:D.L,cilLocationPin:P.r,cilCalendar:W.$,cilClock:O.V,cilTag:N.F,cilFolder:X.b,cilFile:B.T,cilImage:q.a,cilShare:j.O,cilLink:M.l,cilCopy:z.k,cilPrint:H.C,cilChart:U.H,cilSpeedometer:V.I,cilUserFollow:K.d,cilGroup:Q.Q,cilBriefcase:G.Z,cilBuilding:$.d,cilGift:Y.Z,cilHeart:Z.Z,cilThumbUp:J.Q,cilCog:ee.k,cilShieldAlt:ne.l,cilEnvelopeClosed:te.Z,cilPuzzle:re.N,cilMonitor:oe.X,cilAccountLogout:ae.I,cilBell:ie.k,cilEnvelopeOpen:ce.X,cilMoon:se.g,cilSun:ue.x,cilContrast:le.P},pe=t(7321),fe=t(4980),me=t(5458),ve=(t(5086),t(7945),t(4185),t(3851),t(1278),t(7550),[{component:"CNavItem",name:"Dashboard",to:"/dashboard",icon:"cil-speedometer",permission:"dashboard"},{component:"CNavTitle",name:"Verwaltung",permission:"administration"},{component:"CNavItem",name:"Benutzer",to:"/users",icon:"cil-user",permission:"administration"},{component:"CNavItem",name:"Rollen",to:"/roles",icon:"cil-lock-locked",permission:"administration"},{component:"CNavItem",name:"Berechtigungen",to:"/permissions",icon:"cil-shield-alt",permission:"administration"},{component:"CNavTitle",name:"System",permission:"system"},{component:"CNavItem",name:"Plugins",to:"/plugins",icon:"cil-puzzle",permission:"system"},{component:"CNavItem",name:"Einstellungen",to:"/settings",icon:"cil-settings",permission:"system"},{component:"CNavItem",name:"Webhooks",to:"/webhooks",icon:"cil-link",permission:"system"},{component:"CNavTitle",name:"Entwicklung",permission:"development"},{component:"CNavItem",name:"API-Dokumentation",to:"/api-docs",icon:"cil-code",permission:"development"},{component:"CNavItem",name:"System-Status",to:"/system-status",icon:"cil-chart",permission:"development"}]);function he(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];return[].concat(ve,(0,me.A)(e))}var be=t(7471);t(6101);function ge(e,n){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);n&&(r=r.filter(function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable})),t.push.apply(t,r)}return t}var ke=function(e){return decodeURI(e).replace(/#.*$/,"").replace(/(index)?\.(html)$/,"")},Ce=function(e,n){return!!function(e,n){return void 0!==n&&(e.hash===n||ke(e.path)===ke(n))}(e,n.to)||!!n.items&&n.items.some(function(n){return Ce(e,n)})},_e=(0,u.pM)({name:"AppSidebarNav",components:{CNavItem:m.g9,CNavGroup:m.qH,CNavTitle:m.hF},setup:function(){var e=(0,l.lq)(),n=(0,v.n)(),t=(0,u.KR)(!0),r=(0,u.WQ)("icons",{}),a=(0,u.KR)([]);(0,u.sV)(function(){t.value=!1,i()});var i=function(){a.value=[],Object.keys(window).forEach(function(e){e.startsWith("plugin_")&&"object"===(0,o.A)(window[e])&&window[e].navigation&&(a.value=[].concat((0,me.A)(a.value),(0,me.A)(window[e].navigation)))})},c=(0,u.EW)(function(){var e;if(console.log("Navigation berechnen - User:",n.user),console.log("Navigation berechnen - User-Rollen:",null===(e=n.user)||void 0===e?void 0:e.roles),!n.user)return console.log("Kein User - zeige nur Dashboard"),ve.filter(function(e){return"dashboard"===e.permission});var t=ve.filter(function(e){if(!e.permission)return!0;var t=n.canAccess(e.permission);return console.log("Core Item ".concat(e.name," (").concat(e.permission,"): ").concat(t)),t}),r=a.value.filter(function(e){if(!e.permission)return!0;var t=n.canAccess(e.permission);return console.log("Plugin Item ".concat(e.name," (").concat(e.permission,"): ").concat(t)),t}),o=[].concat((0,me.A)(t),(0,me.A)(r));return console.log("Gefilterte Navigation:",o),o}),s=function(n){return n.items?(0,u.h)(m.qH,function(e){for(var n=1;n<arguments.length;n++){var t=null!=arguments[n]?arguments[n]:{};n%2?ge(Object(t),!0).forEach(function(n){(0,fe.A)(e,n,t[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):ge(Object(t)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(t,n))})}return e}({as:"div",compact:!0},t.value&&{visible:n.items.some(function(n){return Ce(e,n)})}),{togglerContent:function(){return[n.icon&&r[n.icon]?(0,u.h)((0,u.g2)("CIcon"),{customClassName:"nav-icon",content:r[n.icon]}):(0,u.h)("span",{class:"nav-icon"},(0,u.h)("span",{class:"nav-icon-bullet"})),n.name]},default:function(){return n.items.map(function(e){return s(e)})}}):n.href?(0,u.h)((0,u.g2)(n.component),{href:n.href,target:"_blank",rel:"noopener noreferrer"},{default:function(){return[n.icon&&r[n.icon]?(0,u.h)((0,u.g2)("CIcon"),{customClassName:"nav-icon",content:r[n.icon]}):(0,u.h)("span",{class:"nav-icon"},(0,u.h)("span",{class:"nav-icon-bullet"})),n.name,n.badge&&(0,u.h)(m.$X,{class:"ms-auto",color:n.badge.color,size:"sm"},{default:function(){return n.badge.text}})]}}):n.to?(0,u.h)(l.Wk,{to:n.to,custom:!0},{default:function(e){return(0,u.h)((0,u.g2)(n.component),{active:e.isActive,as:"div",href:e.href,onClick:function(){return e.navigate()}},{default:function(){return[n.icon&&r[n.icon]?(0,u.h)((0,u.g2)("CIcon"),{customClassName:"nav-icon",content:r[n.icon]}):(0,u.h)("span",{class:"nav-icon"},(0,u.h)("span",{class:"nav-icon-bullet"})),n.name,n.badge&&(0,u.h)(m.$X,{class:"ms-auto",color:n.badge.color,size:"sm"},{default:function(){return n.badge.text}})]}})}}):(0,u.h)((0,u.g2)(n.component),{as:"div"},{default:function(){return n.name}})};return function(){return(0,u.h)(m.Ti,{as:be.A},{default:function(){return c.value.map(function(e){return s(e)})}})}}}),ye=(0,d.nY)("sidebar",function(){var e=(0,u.KR)(void 0),n=(0,u.KR)(!1);return{visible:e,unfoldable:n,toggleVisible:function(n){e.value=void 0!==n?n:!e.value},toggleUnfoldable:function(){n.value=!n.value}}});const Ae={__name:"AppSidebar",setup:function(e){var n=ye(),t=(0,u.WQ)("icons",{});return function(e,r){var o=(0,u.g2)("CIcon"),a=(0,u.g2)("CSidebarBrand"),i=(0,u.g2)("CCloseButton"),c=(0,u.g2)("CSidebarHeader"),s=(0,u.g2)("CSidebarToggler"),d=(0,u.g2)("CSidebarFooter"),p=(0,u.g2)("CSidebar");return(0,u.uX)(),(0,u.Wv)(p,{class:"border-end",colorScheme:"dark",position:"fixed",unfoldable:(0,u.R1)(n).unfoldable,visible:(0,u.R1)(n).visible,onVisibleChange:r[2]||(r[2]=function(e){return(0,u.R1)(n).toggleVisible(e)})},{default:(0,u.k6)(function(){return[(0,u.bF)(c,{class:"border-bottom"},{default:(0,u.k6)(function(){return[(0,u.bF)((0,u.R1)(l.Wk),{custom:"",to:"/"},{default:(0,u.k6)(function(n){var r=n.href,i=n.navigate;return[(0,u.bF)(a,(0,u.v6)(e.$attrs,{as:"a",href:r,onClick:i}),{default:(0,u.k6)(function(){return[(0,u.bF)(o,{"custom-class-name":"sidebar-brand-full",content:(0,u.R1)(t).cilBuilding,height:32},null,8,["content"]),(0,u.bF)(o,{"custom-class-name":"sidebar-brand-narrow",content:(0,u.R1)(t).cilBuilding,height:32},null,8,["content"])]}),_:2},1040,["href","onClick"])]}),_:1}),(0,u.bF)(i,{class:"d-lg-none",dark:"",onClick:r[0]||(r[0]=function(e){return(0,u.R1)(n).toggleVisible()})})]}),_:1}),(0,u.bF)((0,u.R1)(_e)),(0,u.bF)(d,{class:"border-top d-none d-lg-flex"},{default:(0,u.k6)(function(){return[(0,u.bF)(s,{onClick:r[1]||(r[1]=function(e){return(0,u.R1)(n).toggleUnfoldable()})})]}),_:1})]}),_:1},8,["unfoldable","visible"])}}};t(8598);const we={__name:"AppBreadcrumb",setup:function(e){var n=(0,l.lq)(),t=(0,u.EW)(function(){var e=n.path.split("/").filter(Boolean);return e.map(function(n,t){return{name:n.charAt(0).toUpperCase()+n.slice(1),to:"/"+e.slice(0,t+1).join("/")}})});return function(e,n){var r=(0,u.g2)("CBreadcrumbItem"),o=(0,u.g2)("CBreadcrumb");return(0,u.uX)(),(0,u.Wv)(o,{class:"m-0 ms-2"},{default:(0,u.k6)(function(){return[(0,u.bF)(r,{to:{path:"/"}},{default:(0,u.k6)(function(){return n[0]||(n[0]=[(0,u.eW)(" Home ")])}),_:1,__:[0]}),((0,u.uX)(!0),(0,u.CE)(u.FK,null,(0,u.pI)(t.value,function(e){return(0,u.uX)(),(0,u.Wv)(r,{key:e.to,to:e.to},{default:(0,u.k6)(function(){return[(0,u.eW)((0,u.v_)(e.name),1)]}),_:2},1032,["to"])}),128))]}),_:1})}}},Fe={__name:"AppHeaderDropdownAccnt",setup:function(e){var n=(0,l.rd)(),t=(0,v.n)(),r=(0,u.WQ)("icons",{}),o=function(){t.logout(),n.push("/login")},a=function(){n.push("/profile")},i=function(){n.push("/settings")};return function(e,n){var c=(0,u.g2)("CIcon"),s=(0,u.g2)("CAvatar"),l=(0,u.g2)("CDropdownToggle"),d=(0,u.g2)("CDropdownHeader"),p=(0,u.g2)("CDropdownItem"),f=(0,u.g2)("CDropdownDivider"),m=(0,u.g2)("CDropdownMenu"),v=(0,u.g2)("CDropdown");return(0,u.uX)(),(0,u.Wv)(v,{variant:"nav-item"},{default:(0,u.k6)(function(){return[(0,u.bF)(l,{placement:"bottom-end",class:"py-0 pe-0",caret:!1},{default:(0,u.k6)(function(){return[(0,u.bF)(s,{size:"md"},{default:(0,u.k6)(function(){return[(0,u.bF)(c,{content:(0,u.R1)(r).cilUser},null,8,["content"])]}),_:1})]}),_:1}),(0,u.bF)(m,{class:"pt-0"},{default:(0,u.k6)(function(){return[(0,u.bF)(d,{tag:"h6",class:"bg-light fw-semibold py-2"},{default:(0,u.k6)(function(){var e,n;return[(0,u.eW)((0,u.v_)((null===(e=(0,u.R1)(t).user)||void 0===e?void 0:e.fullName)||(null===(n=(0,u.R1)(t).user)||void 0===n?void 0:n.email)||"Account"),1)]}),_:1}),(0,u.bF)(p,{onClick:a},{default:(0,u.k6)(function(){return[(0,u.bF)(c,{content:(0,u.R1)(r).cilUser,class:"me-2"},null,8,["content"]),n[0]||(n[0]=(0,u.eW)(" Profil "))]}),_:1,__:[0]}),(0,u.bF)(p,{onClick:i},{default:(0,u.k6)(function(){return[(0,u.bF)(c,{content:(0,u.R1)(r).cilSettings,class:"me-2"},null,8,["content"]),n[1]||(n[1]=(0,u.eW)(" Einstellungen "))]}),_:1,__:[1]}),(0,u.bF)(f),(0,u.bF)(p,{onClick:o},{default:(0,u.k6)(function(){return[(0,u.bF)(c,{content:(0,u.R1)(r).cilAccountLogout,class:"me-2"},null,8,["content"]),n[2]||(n[2]=(0,u.eW)(" Logout "))]}),_:1,__:[2]})]}),_:1})]}),_:1})}}},xe=Fe,Le={__name:"AppHeader",setup:function(e){var n=(0,u.KR)("mb-4 p-0"),t=(0,m.DJ)("companyos-admin-theme"),r=t.colorMode,o=t.setColorMode,a=ye(),i=(0,u.WQ)("icons",{});return(0,u.sV)(function(){document.addEventListener("scroll",function(){document.documentElement.scrollTop>0?n.value="mb-4 p-0 shadow-sm":n.value="mb-4 p-0"})}),function(e,t){var c=(0,u.g2)("CIcon"),s=(0,u.g2)("CHeaderToggler"),l=(0,u.g2)("CNavLink"),d=(0,u.g2)("CNavItem"),p=(0,u.g2)("CHeaderNav"),f=(0,u.g2)("CDropdownToggle"),m=(0,u.g2)("CDropdownItem"),v=(0,u.g2)("CDropdownMenu"),h=(0,u.g2)("CDropdown"),b=(0,u.g2)("CContainer"),g=(0,u.g2)("CHeader");return(0,u.uX)(),(0,u.Wv)(g,{position:"sticky",class:(0,u.C4)(n.value)},{default:(0,u.k6)(function(){return[(0,u.bF)(b,{class:"border-bottom px-4",fluid:""},{default:(0,u.k6)(function(){return[(0,u.bF)(s,{onClick:t[0]||(t[0]=function(e){return(0,u.R1)(a).toggleVisible()}),style:{"margin-inline-start":"-14px"}},{default:(0,u.k6)(function(){return[(0,u.bF)(c,{content:(0,u.R1)(i).cilMenu,size:"lg"},null,8,["content"])]}),_:1}),(0,u.bF)(p,{class:"d-none d-md-flex"},{default:(0,u.k6)(function(){return[(0,u.bF)(d,null,{default:(0,u.k6)(function(){return[(0,u.bF)(l,{href:"/dashboard"},{default:(0,u.k6)(function(){return t[4]||(t[4]=[(0,u.eW)(" Dashboard ")])}),_:1,__:[4]})]}),_:1}),(0,u.bF)(d,null,{default:(0,u.k6)(function(){return[(0,u.bF)(l,{href:"/users"},{default:(0,u.k6)(function(){return t[5]||(t[5]=[(0,u.eW)("Benutzer")])}),_:1,__:[5]})]}),_:1}),(0,u.bF)(d,null,{default:(0,u.k6)(function(){return[(0,u.bF)(l,{href:"/plugins"},{default:(0,u.k6)(function(){return t[6]||(t[6]=[(0,u.eW)("Plugins")])}),_:1,__:[6]})]}),_:1})]}),_:1}),(0,u.bF)(p,{class:"ms-auto"},{default:(0,u.k6)(function(){return[(0,u.bF)(d,null,{default:(0,u.k6)(function(){return[(0,u.bF)(l,{href:"#"},{default:(0,u.k6)(function(){return[(0,u.bF)(c,{content:(0,u.R1)(i).cilBell,size:"lg"},null,8,["content"])]}),_:1})]}),_:1}),(0,u.bF)(d,null,{default:(0,u.k6)(function(){return[(0,u.bF)(l,{href:"#"},{default:(0,u.k6)(function(){return[(0,u.bF)(c,{content:(0,u.R1)(i).cilList,size:"lg"},null,8,["content"])]}),_:1})]}),_:1}),(0,u.bF)(d,null,{default:(0,u.k6)(function(){return[(0,u.bF)(l,{href:"#"},{default:(0,u.k6)(function(){return[(0,u.bF)(c,{content:(0,u.R1)(i).cilEnvelopeOpen,size:"lg"},null,8,["content"])]}),_:1})]}),_:1})]}),_:1}),(0,u.bF)(p,null,{default:(0,u.k6)(function(){return[t[10]||(t[10]=(0,u.Lk)("li",{class:"nav-item py-1"},[(0,u.Lk)("div",{class:"vr h-100 mx-2 text-body text-opacity-75"})],-1)),(0,u.bF)(h,{variant:"nav-item",placement:"bottom-end"},{default:(0,u.k6)(function(){return[(0,u.bF)(f,{caret:!1},{default:(0,u.k6)(function(){return["dark"===(0,u.R1)(r)?((0,u.uX)(),(0,u.Wv)(c,{key:0,content:(0,u.R1)(i).cilMoon,size:"lg"},null,8,["content"])):"light"===(0,u.R1)(r)?((0,u.uX)(),(0,u.Wv)(c,{key:1,content:(0,u.R1)(i).cilSun,size:"lg"},null,8,["content"])):((0,u.uX)(),(0,u.Wv)(c,{key:2,content:(0,u.R1)(i).cilContrast,size:"lg"},null,8,["content"]))]}),_:1}),(0,u.bF)(v,null,{default:(0,u.k6)(function(){return[(0,u.bF)(m,{active:"light"===(0,u.R1)(r),class:"d-flex align-items-center",component:"button",type:"button",onClick:t[1]||(t[1]=function(e){return(0,u.R1)(o)("light")})},{default:(0,u.k6)(function(){return[(0,u.bF)(c,{class:"me-2",content:(0,u.R1)(i).cilSun,size:"lg"},null,8,["content"]),t[7]||(t[7]=(0,u.eW)(" Light "))]}),_:1,__:[7]},8,["active"]),(0,u.bF)(m,{active:"dark"===(0,u.R1)(r),class:"d-flex align-items-center",component:"button",type:"button",onClick:t[2]||(t[2]=function(e){return(0,u.R1)(o)("dark")})},{default:(0,u.k6)(function(){return[(0,u.bF)(c,{class:"me-2",content:(0,u.R1)(i).cilMoon,size:"lg"},null,8,["content"]),t[8]||(t[8]=(0,u.eW)(" Dark "))]}),_:1,__:[8]},8,["active"]),(0,u.bF)(m,{active:"auto"===(0,u.R1)(r),class:"d-flex align-items-center",component:"button",type:"button",onClick:t[3]||(t[3]=function(e){return(0,u.R1)(o)("auto")})},{default:(0,u.k6)(function(){return[(0,u.bF)(c,{class:"me-2",content:(0,u.R1)(i).cilContrast,size:"lg"},null,8,["content"]),t[9]||(t[9]=(0,u.eW)(" Auto "))]}),_:1,__:[9]},8,["active"])]}),_:1})]}),_:1}),t[11]||(t[11]=(0,u.Lk)("li",{class:"nav-item py-1"},[(0,u.Lk)("div",{class:"vr h-100 mx-2 text-body text-opacity-75"})],-1)),(0,u.bF)(xe)]}),_:1,__:[10,11]})]}),_:1}),(0,u.bF)(b,{class:"px-4",fluid:""},{default:(0,u.k6)(function(){return[(0,u.bF)(we)]}),_:1})]}),_:1},8,["class"])}}};var Re=t(6262);const Se={},Ee=(0,Re.A)(Se,[["render",function(e,n){var t=(0,u.g2)("CFooter");return(0,u.uX)(),(0,u.Wv)(t,{class:"px-4"},{default:(0,u.k6)(function(){return n[0]||(n[0]=[(0,u.Lk)("div",null,[(0,u.Lk)("a",{href:"https://companyos.com",target:"_blank"},"CompanyOS"),(0,u.Lk)("span",{class:"ms-1"},"© 2024 CompanyOS.")],-1),(0,u.Lk)("div",{class:"ms-auto"},[(0,u.Lk)("span",{class:"me-1"},"Powered by"),(0,u.Lk)("a",{href:"https://coreui.io/vue",target:"_blank"},"CoreUI for Vue")],-1)])}),_:1,__:[0]})}]]);function Ie(e,n){var t="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!t){if(Array.isArray(e)||(t=function(e,n){if(e){if("string"==typeof e)return Te(e,n);var t={}.toString.call(e).slice(8,-1);return"Object"===t&&e.constructor&&(t=e.constructor.name),"Map"===t||"Set"===t?Array.from(e):"Arguments"===t||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(t)?Te(e,n):void 0}}(e))||n&&e&&"number"==typeof e.length){t&&(e=t);var r=0,o=function(){};return{s:o,n:function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}},e:function(e){throw e},f:o}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var a,i=!0,c=!1;return{s:function(){t=t.call(e)},n:function(){var e=t.next();return i=e.done,e},e:function(e){c=!0,a=e},f:function(){try{i||null==t.return||t.return()}finally{if(c)throw a}}}}function Te(e,n){(null==n||n>e.length)&&(n=e.length);for(var t=0,r=Array(n);t<n;t++)r[t]=e[t];return r}var De={class:"wrapper d-flex flex-column min-vh-100"},Pe={class:"body flex-grow-1"},We={key:1,class:"plugin-components-overlay"};const Oe={__name:"App",setup:function(e){var n=(0,l.lq)(),t=(0,v.n)(),r=(0,u.EW)(function(){return"/login"!==n.path}),o=(0,u.KR)([]);(0,u.sV)((0,a.A)(s().mark(function e(){return s().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return t.loadTokens(),e.next=1,i();case 1:case"end":return e.stop()}},e)})));var i=function(){var e=(0,a.A)(s().mark(function e(){var n,t,r,o,a,i,u;return s().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=1,fetch("/admin/plugin-components");case 1:if(!(n=e.sent).ok){e.next=12;break}return e.next=2,n.json();case 2:t=e.sent,r=Ie(t),e.prev=3,r.s();case 4:if((o=r.n()).done){e.next=7;break}if(!(a=o.value).css){e.next=5;break}return e.next=5,loadCSS(a.css);case 5:if(!a.js){e.next=6;break}return e.next=6,loadJS(a.js);case 6:e.next=4;break;case 7:e.next=9;break;case 8:e.prev=8,i=e.catch(3),r.e(i);case 9:return e.prev=9,r.f(),e.finish(9);case 10:return e.next=11,c();case 11:console.log("Plugin-Komponenten geladen:",t);case 12:e.next=14;break;case 13:e.prev=13,u=e.catch(0),console.error("Fehler beim Laden der Plugin-Komponenten:",u);case 14:case"end":return e.stop()}},e,null,[[0,13],[3,8,9,10]])}));return function(){return e.apply(this,arguments)}}(),c=function(){var e=(0,a.A)(s().mark(function e(){var n,t,r;return s().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=1,fetch("/admin/plugin-navigation");case 1:if(!(n=e.sent).ok){e.next=3;break}return e.next=2,n.json();case 2:he(t=e.sent),console.log("Plugin-Navigation geladen:",t);case 3:e.next=5;break;case 4:e.prev=4,r=e.catch(0),console.error("Fehler beim Laden der Plugin-Navigation:",r);case 5:case"end":return e.stop()}},e,null,[[0,4]])}));return function(){return e.apply(this,arguments)}}();return function(e,n){var t=(0,u.g2)("router-view"),a=(0,u.g2)("CContainer");return(0,u.uX)(),(0,u.CE)("div",null,[r.value?((0,u.uX)(),(0,u.Wv)(Ae,{key:0})):(0,u.Q3)("v-if",!0),(0,u.Lk)("div",De,[r.value?((0,u.uX)(),(0,u.Wv)(Le,{key:0})):(0,u.Q3)("v-if",!0),(0,u.Lk)("div",Pe,[(0,u.bF)(a,{class:"px-4",lg:""},{default:(0,u.k6)(function(){return[(0,u.bF)(t)]}),_:1})]),r.value?((0,u.uX)(),(0,u.Wv)(Ee,{key:1})):(0,u.Q3)("v-if",!0)]),(0,u.Q3)(" Plugin Components Overlay "),r.value&&o.value.length>0?((0,u.uX)(),(0,u.CE)("div",We,[((0,u.uX)(!0),(0,u.CE)(u.FK,null,(0,u.pI)(o.value,function(e){return(0,u.uX)(),(0,u.CE)("div",{key:e.name,class:"plugin-component"},[((0,u.uX)(),(0,u.Wv)((0,u.$y)(e.name),(0,u.v6)({ref_for:!0},e.props||{}),null,16))])}),128))])):(0,u.Q3)("v-if",!0)])}}},Ne=Oe;var Xe={class:"dashboard"},Be={class:"dashboard-header"},qe={class:"dashboard-actions"},je={class:"dashboard-grid"},Me={class:"dashboard-card"},ze={class:"card-body"},He={class:"dashboard-card"},Ue={class:"card-body"},Ve={class:"stats-grid"},Ke={class:"stat-item"},Qe={class:"stat-value"},Ge={class:"stat-item"},$e={class:"stat-value"},Ye={class:"stat-item"},Ze={class:"stat-value"},Je={class:"dashboard-card"},en={class:"card-body"},nn={key:0,class:"no-activity"},tn={key:1,class:"activity-list"},rn={class:"activity-icon"},on={class:"activity-content"},an={class:"activity-title"},cn={class:"activity-time"};const sn={name:"Dashboard",setup:function(){var e=(0,v.n)(),n=(0,u.KR)(!1),t=(0,u.KR)({users:0,plugins:0,roles:0}),r=(0,u.KR)([]),o=(0,u.EW)(function(){return e.user}),i=(0,u.EW)(function(){return e.canAccess}),c=function(){var e=(0,a.A)(s().mark(function e(){var o,a,i;return s().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return n.value=!0,e.prev=1,e.next=2,f.A.get("/api/dashboard/stats");case 2:return o=e.sent,t.value=o.data,e.next=3,f.A.get("/api/dashboard/activity");case 3:a=e.sent,r.value=a.data,e.next=5;break;case 4:e.prev=4,i=e.catch(1),console.error("Fehler beim Laden der Dashboard-Daten:",i);case 5:return e.prev=5,n.value=!1,e.finish(5);case 6:case"end":return e.stop()}},e,null,[[1,4,5,6]])}));return function(){return e.apply(this,arguments)}}();return(0,u.sV)(function(){c()}),{user:o,canAccess:i,loading:n,stats:t,recentActivity:r,formatDate:function(e){return e?new Date(e).toLocaleString("de-DE"):"Gerade eben"},refreshData:function(){c()}}}},un=(0,Re.A)(sn,[["render",function(e,n,t,r,o,a){var i;return(0,u.uX)(),(0,u.CE)("div",Xe,[(0,u.Lk)("div",Be,[n[2]||(n[2]=(0,u.Lk)("h1",null,"Dashboard",-1)),(0,u.Lk)("div",qe,[(0,u.Lk)("button",{class:"btn btn-primary",onClick:n[0]||(n[0]=function(){return r.refreshData&&r.refreshData.apply(r,arguments)})},n[1]||(n[1]=[(0,u.Lk)("i",{class:"fas fa-sync-alt"},null,-1),(0,u.eW)(" Aktualisieren ")]))])]),(0,u.Lk)("div",je,[(0,u.Q3)(" Welcome Card "),(0,u.Lk)("div",Me,[n[4]||(n[4]=(0,u.Lk)("div",{class:"card-header"},[(0,u.Lk)("h3",null,"Willkommen")],-1)),(0,u.Lk)("div",ze,[(0,u.Lk)("p",null,"Hallo "+(0,u.v_)((null===(i=r.user)||void 0===i?void 0:i.name)||"Benutzer")+"!",1),n[3]||(n[3]=(0,u.Lk)("p",null,"Willkommen im CompanyOS Backend.",-1))])]),(0,u.Q3)(" Quick Stats "),(0,u.Lk)("div",He,[n[8]||(n[8]=(0,u.Lk)("div",{class:"card-header"},[(0,u.Lk)("h3",null,"Schnellstatistiken")],-1)),(0,u.Lk)("div",Ue,[(0,u.Lk)("div",Ve,[(0,u.Lk)("div",Ke,[(0,u.Lk)("div",Qe,(0,u.v_)(r.stats.users||0),1),n[5]||(n[5]=(0,u.Lk)("div",{class:"stat-label"},"Benutzer",-1))]),(0,u.Lk)("div",Ge,[(0,u.Lk)("div",$e,(0,u.v_)(r.stats.plugins||0),1),n[6]||(n[6]=(0,u.Lk)("div",{class:"stat-label"},"Plugins",-1))]),(0,u.Lk)("div",Ye,[(0,u.Lk)("div",Ze,(0,u.v_)(r.stats.roles||0),1),n[7]||(n[7]=(0,u.Lk)("div",{class:"stat-label"},"Rollen",-1))])])])]),(0,u.Q3)(" Recent Activity "),(0,u.Lk)("div",Je,[n[10]||(n[10]=(0,u.Lk)("div",{class:"card-header"},[(0,u.Lk)("h3",null,"Aktuelle Aktivitäten")],-1)),(0,u.Lk)("div",en,[0===r.recentActivity.length?((0,u.uX)(),(0,u.CE)("div",nn,n[9]||(n[9]=[(0,u.Lk)("p",null,"Keine aktuellen Aktivitäten",-1)]))):((0,u.uX)(),(0,u.CE)("div",tn,[((0,u.uX)(!0),(0,u.CE)(u.FK,null,(0,u.pI)(r.recentActivity,function(e){return(0,u.uX)(),(0,u.CE)("div",{key:e.id,class:"activity-item"},[(0,u.Lk)("div",rn,[(0,u.Lk)("i",{class:(0,u.C4)(e.icon)},null,2)]),(0,u.Lk)("div",on,[(0,u.Lk)("div",an,(0,u.v_)(e.title),1),(0,u.Lk)("div",cn,(0,u.v_)(r.formatDate(e.timestamp)),1)])])}),128))]))])])])])}],["__scopeId","data-v-49f2e121"]]);var ln={class:"bg-light min-vh-100 d-flex flex-row align-items-center"},dn={class:"form-check mt-3"};const pn={__name:"Login",setup:function(e){var n=(0,l.rd)(),t=(0,v.n)(),r=(0,u.KR)({username:"",password:"",remember:!1}),o=(0,u.EW)(function(){return t.loading}),i=(0,u.EW)({get:function(){return t.error},set:function(e){t.error=e}}),c=function(){var e=(0,a.A)(s().mark(function e(){return s().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=1,t.login({username:r.value.username,password:r.value.password,remember:r.value.remember});case 1:e.sent&&n.push("/dashboard");case 2:case"end":return e.stop()}},e)}));return function(){return e.apply(this,arguments)}}();return function(e,n){var t=(0,u.g2)("CIcon"),a=(0,u.g2)("CInputGroupText"),s=(0,u.g2)("CFormInput"),l=(0,u.g2)("CInputGroup"),d=(0,u.g2)("CSpinner"),p=(0,u.g2)("CButton"),f=(0,u.g2)("CCol"),m=(0,u.g2)("CRow"),v=(0,u.g2)("CFormCheck"),h=(0,u.g2)("CForm"),b=(0,u.g2)("CCardBody"),g=(0,u.g2)("CCard"),k=(0,u.g2)("CCardGroup"),C=(0,u.g2)("CAlert"),_=(0,u.g2)("CContainer");return(0,u.uX)(),(0,u.CE)("div",ln,[(0,u.bF)(_,null,{default:(0,u.k6)(function(){return[(0,u.bF)(m,{class:"justify-content-center"},{default:(0,u.k6)(function(){return[(0,u.bF)(f,{md:"8"},{default:(0,u.k6)(function(){return[(0,u.bF)(k,null,{default:(0,u.k6)(function(){return[(0,u.bF)(g,{class:"p-4"},{default:(0,u.k6)(function(){return[(0,u.bF)(b,null,{default:(0,u.k6)(function(){return[(0,u.bF)(h,{onSubmit:(0,u.D$)(c,["prevent"])},{default:(0,u.k6)(function(){return[n[5]||(n[5]=(0,u.Lk)("h1",null,"Login",-1)),n[6]||(n[6]=(0,u.Lk)("p",{class:"text-medium-emphasis"},"Melden Sie sich in Ihrem Account an",-1)),(0,u.bF)(l,{class:"mb-3"},{default:(0,u.k6)(function(){return[(0,u.bF)(a,null,{default:(0,u.k6)(function(){return[(0,u.bF)(t,{icon:"cil-user"})]}),_:1}),(0,u.bF)(s,{modelValue:r.value.username,"onUpdate:modelValue":n[0]||(n[0]=function(e){return r.value.username=e}),placeholder:"E-Mail",autocomplete:"username",required:""},null,8,["modelValue"])]}),_:1}),(0,u.bF)(l,{class:"mb-4"},{default:(0,u.k6)(function(){return[(0,u.bF)(a,null,{default:(0,u.k6)(function(){return[(0,u.bF)(t,{icon:"cil-lock-locked"})]}),_:1}),(0,u.bF)(s,{modelValue:r.value.password,"onUpdate:modelValue":n[1]||(n[1]=function(e){return r.value.password=e}),type:"password",placeholder:"Passwort",autocomplete:"current-password",required:""},null,8,["modelValue"])]}),_:1}),(0,u.bF)(m,null,{default:(0,u.k6)(function(){return[(0,u.bF)(f,{xs:"6"},{default:(0,u.k6)(function(){return[(0,u.bF)(p,{type:"submit",color:"primary",class:"px-4",disabled:o.value},{default:(0,u.k6)(function(){return[o.value?((0,u.uX)(),(0,u.Wv)(d,{key:0,size:"sm",class:"me-2"})):(0,u.Q3)("v-if",!0),(0,u.eW)(" "+(0,u.v_)(o.value?"Anmelden...":"Anmelden"),1)]}),_:1},8,["disabled"])]}),_:1}),(0,u.bF)(f,{xs:"6",class:"text-right"},{default:(0,u.k6)(function(){return[(0,u.bF)(p,{color:"link",class:"px-0"},{default:(0,u.k6)(function(){return n[4]||(n[4]=[(0,u.eW)(" Passwort vergessen? ")])}),_:1,__:[4]})]}),_:1})]}),_:1}),(0,u.Lk)("div",dn,[(0,u.bF)(v,{modelValue:r.value.remember,"onUpdate:modelValue":n[2]||(n[2]=function(e){return r.value.remember=e}),type:"checkbox",id:"remember",label:"Angemeldet bleiben"},null,8,["modelValue"])])]}),_:1,__:[5,6]})]}),_:1})]}),_:1}),(0,u.bF)(g,{class:"text-white bg-primary py-5"},{default:(0,u.k6)(function(){return[(0,u.bF)(b,{class:"text-center"},{default:(0,u.k6)(function(){return[(0,u.Lk)("div",null,[n[8]||(n[8]=(0,u.Lk)("h2",null,"CompanyOS Admin",-1)),n[9]||(n[9]=(0,u.Lk)("p",null," Willkommen im CompanyOS Backend-System. Hier können Sie alle administrativen Aufgaben verwalten. ",-1)),(0,u.bF)(p,{color:"primary",class:"mt-3",active:"",tabindex:"-1"},{default:(0,u.k6)(function(){return n[7]||(n[7]=[(0,u.eW)(" Registrieren! ")])}),_:1,__:[7]})])]}),_:1})]}),_:1})]}),_:1})]}),_:1})]}),_:1}),(0,u.Q3)(" Fehlermeldung "),i.value?((0,u.uX)(),(0,u.Wv)(C,{key:0,color:"danger",class:"mt-3",dismissible:"",onClose:n[3]||(n[3]=function(e){return i.value=null})},{default:(0,u.k6)(function(){return[(0,u.eW)((0,u.v_)(i.value),1)]}),_:1})):(0,u.Q3)("v-if",!0)]}),_:1})])}}};function fn(e,n){var t="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!t){if(Array.isArray(e)||(t=function(e,n){if(e){if("string"==typeof e)return mn(e,n);var t={}.toString.call(e).slice(8,-1);return"Object"===t&&e.constructor&&(t=e.constructor.name),"Map"===t||"Set"===t?Array.from(e):"Arguments"===t||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(t)?mn(e,n):void 0}}(e))||n&&e&&"number"==typeof e.length){t&&(e=t);var r=0,o=function(){};return{s:o,n:function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}},e:function(e){throw e},f:o}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var a,i=!0,c=!1;return{s:function(){t=t.call(e)},n:function(){var e=t.next();return i=e.done,e},e:function(e){c=!0,a=e},f:function(){try{i||null==t.return||t.return()}finally{if(c)throw a}}}}function mn(e,n){(null==n||n>e.length)&&(n=e.length);for(var t=0,r=Array(n);t<n;t++)r[t]=e[t];return r}var vn=[{path:"/",redirect:"/dashboard"},{path:"/login",name:"Login",component:(0,Re.A)(pn,[["__scopeId","data-v-60c1d344"]]),meta:{requiresAuth:!1}},{path:"/dashboard",name:"Dashboard",component:un,meta:{requiresAuth:!0}},{path:"/profile",name:"Profile",component:function(){return t.e(81).then(t.bind(t,9081))},meta:{requiresAuth:!0}},{path:"/users",name:"Users",component:function(){return t.e(111).then(t.bind(t,1111))},meta:{requiresAuth:!0,requiresRole:"ROLE_ADMIN"}},{path:"/roles",name:"Roles",component:function(){return Promise.all([t.e(96),t.e(539)]).then(t.bind(t,1539))},meta:{requiresAuth:!0,requiresRole:"ROLE_ADMIN"}},{path:"/permissions",name:"Permissions",component:function(){return Promise.all([t.e(96),t.e(295)]).then(t.bind(t,8295))},meta:{requiresAuth:!0,requiresRole:"ROLE_ADMIN"}},{path:"/plugins",name:"Plugins",component:function(){return Promise.all([t.e(96),t.e(74)]).then(t.bind(t,1074))},meta:{requiresAuth:!0,requiresRole:"ROLE_ADMIN"}},{path:"/settings",name:"Settings",component:function(){return t.e(664).then(t.bind(t,7664))},meta:{requiresAuth:!0,requiresRole:"ROLE_ADMIN"}},{path:"/webhooks",name:"Webhooks",component:function(){return Promise.all([t.e(96),t.e(643)]).then(t.bind(t,1643))},meta:{requiresAuth:!0,requiresRole:"ROLE_ADMIN"}},{path:"/api-docs",name:"ApiDocs",component:function(){return Promise.all([t.e(96),t.e(477)]).then(t.bind(t,6477))},meta:{requiresAuth:!0,requiresRole:"ROLE_ADMIN"}}],hn=(0,l.aE)({history:(0,l.LA)("/admin"),routes:vn}),bn=(0,u.Ef)(Ne),gn=(0,d.Ey)();function kn(){return Cn.apply(this,arguments)}function Cn(){return(Cn=(0,a.A)(s().mark(function e(){var n,t,r,o;return s().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=1,fetch("/api/plugins");case 1:if((n=e.sent).ok){e.next=2;break}throw new Error("HTTP ".concat(n.status,": ").concat(n.statusText));case 2:return e.next=3,n.json();case 3:return t=e.sent,r=t.filter(function(e){return e.active}),console.log("Aktive Plugins gefunden:",r.map(function(e){return e.name})),e.abrupt("return",r);case 4:return e.prev=4,o=e.catch(0),console.error("Fehler beim Laden der aktiven Plugins:",o),e.abrupt("return",[]);case 5:case"end":return e.stop()}},e,null,[[0,4]])}))).apply(this,arguments)}function _n(e){return yn.apply(this,arguments)}function yn(){return(yn=(0,a.A)(s().mark(function e(n){var t,r,o,a,i,c;return s().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:console.log("Lade Plugin-Entrypoints für:",n.map(function(e){return e.name})),t=fn(n),e.prev=1,t.s();case 2:if((r=t.n()).done){e.next=7;break}return o=r.value,a="/bundles/".concat(o.name.toLowerCase(),"/dist/plugin.js"),e.prev=3,e.next=4,An(a);case 4:console.log("✅ Plugin geladen: ".concat(o.name)),e.next=6;break;case 5:e.prev=5,i=e.catch(3),console.error("❌ Plugin-Fehler: ".concat(o.name),i);case 6:e.next=2;break;case 7:e.next=9;break;case 8:e.prev=8,c=e.catch(1),t.e(c);case 9:return e.prev=9,t.f(),e.finish(9);case 10:case"end":return e.stop()}},e,null,[[1,8,9,10],[3,5]])}))).apply(this,arguments)}function An(e){return new Promise(function(n,t){var r=document.createElement("script");r.src=e,r.onload=n,r.onerror=t,document.head.appendChild(r)})}function wn(){Object.keys(window).forEach(function(e){if(e.startsWith("plugin_")&&"object"===(0,o.A)(window[e])){var n=e.replace("plugin_","");console.log("Plugin-Komponenten registrieren: ".concat(n)),window[e].components&&Object.entries(window[e].components).forEach(function(e){var n=(0,i.A)(e,2),t=n[0],r=n[1];bn.component(t,r)}),window[e].routes&&window[e].routes.forEach(function(e){hn.addRoute(e)})}})}function Fn(){return(Fn=(0,a.A)(s().mark(function e(){var n;return s().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=1,kn();case 1:return n=e.sent,e.next=2,_n(n);case 2:wn(),bn.use(gn),bn.use(hn),bn.mount("#app");case 3:case"end":return e.stop()}},e)}))).apply(this,arguments)}gn.use(p.A),Object.entries(r).forEach(function(e){var n=(0,i.A)(e,2),t=n[0],r=n[1];bn.component(t,r)}),function(){Fn.apply(this,arguments)}(),bn.component("CIcon",pe.Ay),bn.provide("icons",de),bn.component("CContainer",m.T5),bn.component("CSidebar",m._z),bn.component("CSidebarHeader",m.dN),bn.component("CSidebarBrand",m.lD),bn.component("CSidebarNav",m.Ti),bn.component("CSidebarFooter",m.tu),bn.component("CSidebarToggler",m.yk),bn.component("CCloseButton",m.EA),bn.component("CHeader",m.vs),bn.component("CHeaderToggler",m.hf),bn.component("CHeaderNav",m.qY),bn.component("CNavItem",m.g9),bn.component("CNavLink",m.HQ),bn.component("CFooter",m.FO),bn.component("CBreadcrumb",m.VT),bn.component("CBreadcrumbItem",m.Iz),bn.component("CDropdown",m.ji),bn.component("CDropdownToggle",m.VH),bn.component("CDropdownMenu",m.QR),bn.component("CDropdownItem",m.kd),bn.component("CDropdownHeader",m.IE),bn.component("CDropdownDivider",m.A9),bn.component("CAvatar",m.re),bn.component("CNavGroup",m.qH),bn.component("CNavTitle",m.hF),bn.component("CBadge",m.$X),bn.component("CCard",m.E$),bn.component("CCardHeader",m.V0),bn.component("CCardBody",m.W6),bn.component("CCardGroup",m.x$),bn.component("CCol",m.UF),bn.component("CRow",m.sK),bn.component("CButton",m.Q_),bn.component("CForm",m.qI),bn.component("CFormInput",m.OG),bn.component("CInputGroup",m.BG),bn.component("CInputGroupText",m.sk),bn.component("CAlert",m.kj),bn.component("CSpinner",m.JT),bn.component("CListGroup",m.XR),bn.component("CListGroupItem",m.y5),bn.component("CWidgetStatsF",m.eE);var xn=(0,v.n)();xn.loadTokens(),xn.accessToken&&xn.fetchProfile(),hn.beforeEach(function(e,n,t){e.meta.requiresAuth&&!xn.accessToken?t("/login"):"/login"===e.path&&xn.accessToken||e.meta.requiresRole&&!xn.hasRole(e.meta.requiresRole)?t("/dashboard"):t()}),f.A.interceptors.request.use(function(e){return xn.accessToken&&(e.headers.Authorization="Bearer ".concat(xn.accessToken)),e.headers["X-Requested-With"]="XMLHttpRequest",e},function(e){return Promise.reject(e)}),f.A.interceptors.response.use(function(e){return e},function(){var e=(0,a.A)(s().mark(function e(n){var t;return s().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(401!==(null===(t=n.response)||void 0===t?void 0:t.status)||!xn.refreshToken){e.next=3;break}return e.next=1,xn.refresh();case 1:if(!e.sent){e.next=2;break}return n.config.headers.Authorization="Bearer ".concat(xn.accessToken),e.abrupt("return",(0,f.A)(n.config));case 2:xn.logout(),hn.push("/login");case 3:return e.abrupt("return",Promise.reject(n));case 4:case"end":return e.stop()}},e)}));return function(n){return e.apply(this,arguments)}}())},7383:(e,n,t)=>{t.d(n,{n:()=>p});var r=t(467),o=t(4756),a=t.n(o),i=(t(6280),t(6918),t(4423),t(3792),t(9089),t(739),t(3110),t(9432),t(6099),t(7495),t(906),t(1699),t(7764),t(2762),t(2953),t(6031),t(8408),t(1774)),c=t(1083),s="auth_storage";function u(e){return e.trim().toLowerCase()}function l(e){return/^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(e)}function d(e){return e&&e.length>=8}var p=(0,i.nY)("auth",{state:function(){return{accessToken:null,refreshToken:null,expiresAt:null,scopes:[],user:null,loading:!1,error:null,remember:!1}},getters:{hasRole:function(e){return function(n){return!(!e.user||!e.user.roles)&&e.user.roles.includes(n)}},canAccess:function(e){return function(n){if(!e.user||!e.user.roles)return!1;var t=e.user.roles;if(t.includes("ROLE_ADMIN"))return!0;switch(n){case"dashboard":case"profile":return t.includes("ROLE_CUSTOMER")||t.includes("ROLE_EMPLOYEE")||t.includes("ROLE_ADMIN");case"administration":case"system":case"development":return t.includes("ROLE_ADMIN");default:return!1}}},dashboardType:function(e){return e.user&&e.user.roles?e.user.roles.includes("ROLE_ADMIN")?"admin":e.user.roles.includes("ROLE_EMPLOYEE")?"employee":"customer":"customer"}},actions:{login:function(e){var n=this;return(0,r.A)(a().mark(function t(){var r,o,i,s,p,f,m,v,h,b;return a().wrap(function(t){for(;;)switch(t.prev=t.next){case 0:if(r=e.username,o=e.password,i=e.remember,s=void 0!==i&&i,n.loading=!0,n.error=null,n.remember=s,t.prev=1,l(p=u(r))){t.next=2;break}throw new Error("Ungültige E-Mail-Adresse");case 2:if(d(o)){t.next=3;break}throw new Error("Passwort muss mindestens 8 Zeichen lang sein");case 3:return f=new URLSearchParams({grant_type:"password",client_id:"backend",username:p,password:o}),t.next=4,c.A.post("/api/oauth2/token",f,{headers:{"Content-Type":"application/x-www-form-urlencoded"}});case 4:return m=t.sent,v=m.data,n.setTokens(v,s),n.loading=!1,t.next=5,n.fetchProfile();case 5:return t.abrupt("return",!0);case 6:return t.prev=6,b=t.catch(1),n.error=(null===(h=b.response)||void 0===h||null===(h=h.data)||void 0===h?void 0:h.message)||b.message||"Login fehlgeschlagen",n.loading=!1,t.abrupt("return",!1);case 7:case"end":return t.stop()}},t,null,[[1,6]])}))()},setTokens:function(e){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.remember;this.accessToken=e.access_token,this.refreshToken=e.refresh_token,this.expiresAt=Date.now()+1e3*e.expires_in,this.scopes=e.scope?e.scope.split(" "):[],this.remember=n;var t=function(e){return e?localStorage:sessionStorage}(n);t.setItem(s,JSON.stringify({accessToken:this.accessToken,refreshToken:this.refreshToken,expiresAt:this.expiresAt,scopes:this.scopes,remember:this.remember}))},loadTokens:function(){var e=localStorage.getItem(s)||sessionStorage.getItem(s);e&&(e=JSON.parse(e),this.accessToken=e.accessToken,this.refreshToken=e.refreshToken,this.expiresAt=e.expiresAt,this.scopes=e.scopes,this.remember=e.remember)},logout:function(){this.accessToken=null,this.refreshToken=null,this.expiresAt=null,this.scopes=[],this.user=null,localStorage.removeItem(s),sessionStorage.removeItem(s)},refresh:function(){var e=this;return(0,r.A)(a().mark(function n(){var t,r,o;return a().wrap(function(n){for(;;)switch(n.prev=n.next){case 0:if(e.refreshToken){n.next=1;break}return n.abrupt("return",!1);case 1:return n.prev=1,t=new URLSearchParams({grant_type:"refresh_token",client_id:"backend",refresh_token:e.refreshToken}),n.next=2,c.A.post("/api/oauth2/token",t,{headers:{"Content-Type":"application/x-www-form-urlencoded"}});case 2:return r=n.sent,o=r.data,e.setTokens(o,e.remember),n.abrupt("return",!0);case 3:return n.prev=3,n.catch(1),e.logout(),n.abrupt("return",!1);case 4:case"end":return n.stop()}},n,null,[[1,3]])}))()},fetchProfile:function(){var e=this;return(0,r.A)(a().mark(function n(){var t,r,o,i;return a().wrap(function(n){for(;;)switch(n.prev=n.next){case 0:if(e.accessToken){n.next=1;break}return n.abrupt("return");case 1:return n.prev=1,n.next=2,c.A.get("/api/user/profile",{headers:{Authorization:"Bearer ".concat(e.accessToken)}});case 2:r=n.sent,o=r.data,console.log("User-Profil geladen:",o),e.user=o,console.log("User-Rollen:",null===(t=e.user)||void 0===t?void 0:t.roles),n.next=4;break;case 3:n.prev=3,i=n.catch(1),console.error("Profil konnte nicht abgerufen werden:",i);case 4:case"end":return n.stop()}},n,null,[[1,3]])}))()},hasScope:function(e){return this.scopes.includes(e)}}})}},e=>{e.O(0,[536,96],()=>{return n=7205,e(e.s=n);var n});e.O()}]);